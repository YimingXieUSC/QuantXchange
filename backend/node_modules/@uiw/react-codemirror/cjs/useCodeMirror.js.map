{
  "version": 3,
  "names": [
    "_react",
    "require",
    "_state",
    "_commands",
    "_view",
    "_codemirrorExtensionsBasicSetup",
    "_themeOneDark",
    "_utils",
    "External",
    "Annotation",
    "define",
    "useCodeMirror",
    "props",
    "value",
    "selection",
    "onChange",
    "onStatistics",
    "onCreateEditor",
    "onUpdate",
    "_props$extensions",
    "extensions",
    "autoFocus",
    "_props$theme",
    "theme",
    "_props$height",
    "height",
    "_props$minHeight",
    "minHeight",
    "_props$maxHeight",
    "maxHeight",
    "_props$placeholder",
    "placeholder",
    "placeholderStr",
    "_props$width",
    "width",
    "_props$minWidth",
    "minWidth",
    "_props$maxWidth",
    "maxWidth",
    "_props$editable",
    "editable",
    "_props$readOnly",
    "readOnly",
    "_props$indentWithTab",
    "indentWithTab",
    "defaultIndentWithTab",
    "_props$basicSetup",
    "basicSetup",
    "defaultBasicSetup",
    "root",
    "initialState",
    "_useState",
    "useState",
    "_useState2",
    "_slicedToArray2",
    "container",
    "setContainer",
    "_useState3",
    "_useState4",
    "view",
    "setView",
    "_useState5",
    "_useState6",
    "state",
    "setState",
    "defaultLightThemeOption",
    "EditorView",
    "backgroundColor",
    "dark",
    "defaultThemeOption",
    "updateListener",
    "of",
    "vu",
    "docChanged",
    "transactions",
    "some",
    "tr",
    "annotation",
    "doc",
    "toString",
    "getStatistics",
    "getExtensions",
    "unshift",
    "keymap",
    "push",
    "oneDark",
    "EditorState",
    "concat",
    "useEffect",
    "config",
    "stateCurrent",
    "fromJSON",
    "json",
    "fields",
    "create",
    "viewCurrent",
    "parent",
    "undefined",
    "destroy",
    "focus",
    "dispatch",
    "effects",
    "StateEffect",
    "reconfigure",
    "currentValue",
    "changes",
    "from",
    "to",
    "length",
    "insert",
    "annotations"
  ],
  "sources": [
    "../src/useCodeMirror.ts"
  ],
  "sourcesContent": [
    "import { useEffect, useState } from 'react';\nimport { Annotation, EditorState, StateEffect } from '@codemirror/state';\nimport { indentWithTab } from '@codemirror/commands';\nimport { EditorView, keymap, ViewUpdate, placeholder } from '@codemirror/view';\nimport { basicSetup } from '@uiw/codemirror-extensions-basic-setup';\nimport { oneDark } from '@codemirror/theme-one-dark';\nimport { getStatistics } from './utils';\nimport { ReactCodeMirrorProps } from '.';\n\nconst External = Annotation.define<boolean>();\n\nexport interface UseCodeMirror extends ReactCodeMirrorProps {\n  container?: HTMLDivElement | null;\n}\n\nexport function useCodeMirror(props: UseCodeMirror) {\n  const {\n    value,\n    selection,\n    onChange,\n    onStatistics,\n    onCreateEditor,\n    onUpdate,\n    extensions = [],\n    autoFocus,\n    theme = 'light',\n    height = '',\n    minHeight = '',\n    maxHeight = '',\n    placeholder: placeholderStr = '',\n    width = '',\n    minWidth = '',\n    maxWidth = '',\n    editable = true,\n    readOnly = false,\n    indentWithTab: defaultIndentWithTab = true,\n    basicSetup: defaultBasicSetup = true,\n    root,\n    initialState,\n  } = props;\n  const [container, setContainer] = useState<HTMLDivElement>();\n  const [view, setView] = useState<EditorView>();\n  const [state, setState] = useState<EditorState>();\n  const defaultLightThemeOption = EditorView.theme(\n    {\n      '&': {\n        backgroundColor: '#fff',\n      },\n    },\n    {\n      dark: false,\n    },\n  );\n  const defaultThemeOption = EditorView.theme({\n    '&': {\n      height,\n      minHeight,\n      maxHeight,\n      width,\n      minWidth,\n      maxWidth,\n    },\n  });\n  const updateListener = EditorView.updateListener.of((vu: ViewUpdate) => {\n    if (\n      vu.docChanged &&\n      typeof onChange === 'function' &&\n      // Fix echoing of the remote changes:\n      // If transaction is market as remote we don't have to call `onChange` handler again\n      !vu.transactions.some((tr) => tr.annotation(External))\n    ) {\n      const doc = vu.state.doc;\n      const value = doc.toString();\n      onChange(value, vu);\n    }\n    onStatistics && onStatistics(getStatistics(vu));\n  });\n\n  let getExtensions = [updateListener, defaultThemeOption];\n  if (defaultIndentWithTab) {\n    getExtensions.unshift(keymap.of([indentWithTab]));\n  }\n  if (defaultBasicSetup) {\n    if (typeof defaultBasicSetup === 'boolean') {\n      getExtensions.unshift(basicSetup());\n    } else {\n      getExtensions.unshift(basicSetup(defaultBasicSetup));\n    }\n  }\n\n  if (placeholderStr) {\n    getExtensions.unshift(placeholder(placeholderStr));\n  }\n\n  switch (theme) {\n    case 'light':\n      getExtensions.push(defaultLightThemeOption);\n      break;\n    case 'dark':\n      getExtensions.push(oneDark);\n      break;\n    case 'none':\n      break;\n    default:\n      getExtensions.push(theme);\n      break;\n  }\n\n  if (editable === false) {\n    getExtensions.push(EditorView.editable.of(false));\n  }\n  if (readOnly) {\n    getExtensions.push(EditorState.readOnly.of(true));\n  }\n\n  if (onUpdate && typeof onUpdate === 'function') {\n    getExtensions.push(EditorView.updateListener.of(onUpdate));\n  }\n  getExtensions = getExtensions.concat(extensions);\n\n  useEffect(() => {\n    if (container && !state) {\n      const config = {\n        doc: value,\n        selection,\n        extensions: getExtensions,\n      };\n      const stateCurrent = initialState\n        ? EditorState.fromJSON(initialState.json, config, initialState.fields)\n        : EditorState.create(config);\n      setState(stateCurrent);\n      if (!view) {\n        const viewCurrent = new EditorView({\n          state: stateCurrent,\n          parent: container,\n          root,\n        });\n        setView(viewCurrent);\n        onCreateEditor && onCreateEditor(viewCurrent, stateCurrent);\n      }\n    }\n    return () => {\n      if (view) {\n        setState(undefined);\n        setView(undefined);\n      }\n    };\n  }, [container, state]);\n\n  useEffect(() => setContainer(props.container!), [props.container]);\n\n  useEffect(\n    () => () => {\n      if (view) {\n        view.destroy();\n        setView(undefined);\n      }\n    },\n    [view],\n  );\n\n  useEffect(() => {\n    if (autoFocus && view) {\n      view.focus();\n    }\n  }, [autoFocus, view]);\n\n  useEffect(() => {\n    if (view) {\n      view.dispatch({ effects: StateEffect.reconfigure.of(getExtensions) });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    theme,\n    extensions,\n    height,\n    minHeight,\n    maxHeight,\n    width,\n    minWidth,\n    maxWidth,\n    placeholderStr,\n    editable,\n    readOnly,\n    defaultIndentWithTab,\n    defaultBasicSetup,\n    onChange,\n    onUpdate,\n  ]);\n\n  useEffect(() => {\n    if (value === undefined) {\n      return;\n    }\n    const currentValue = view ? view.state.doc.toString() : '';\n    if (view && value !== currentValue) {\n      view.dispatch({\n        changes: { from: 0, to: currentValue.length, insert: value || '' },\n        annotations: [External.of(true)],\n      });\n    }\n  }, [value, view]);\n\n  return { state, setState, view, setView, container, setContainer };\n}\n"
  ],
  "mappings": ";;;;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,MAAA,GAAAD,OAAA;AACA,IAAAE,SAAA,GAAAF,OAAA;AACA,IAAAG,KAAA,GAAAH,OAAA;AACA,IAAAI,+BAAA,GAAAJ,OAAA;AACA,IAAAK,aAAA,GAAAL,OAAA;AACA,IAAAM,MAAA,GAAAN,OAAA;AAGA,IAAMO,QAAQ,GAAGC,iBAAU,CAACC,MAAM,EAAW;AAMtC,SAASC,aAAaA,CAACC,KAAoB,EAAE;EAClD,IACEC,KAAK,GAsBHD,KAAK,CAtBPC,KAAK;IACLC,SAAS,GAqBPF,KAAK,CArBPE,SAAS;IACTC,QAAQ,GAoBNH,KAAK,CApBPG,QAAQ;IACRC,YAAY,GAmBVJ,KAAK,CAnBPI,YAAY;IACZC,cAAc,GAkBZL,KAAK,CAlBPK,cAAc;IACdC,QAAQ,GAiBNN,KAAK,CAjBPM,QAAQ;IAAAC,iBAAA,GAiBNP,KAAK,CAhBPQ,UAAU;IAAVA,UAAU,GAAAD,iBAAA,cAAG,EAAE,GAAAA,iBAAA;IACfE,SAAS,GAePT,KAAK,CAfPS,SAAS;IAAAC,YAAA,GAePV,KAAK,CAdPW,KAAK;IAALA,KAAK,GAAAD,YAAA,cAAG,OAAO,GAAAA,YAAA;IAAAE,aAAA,GAcbZ,KAAK,CAbPa,MAAM;IAANA,MAAM,GAAAD,aAAA,cAAG,EAAE,GAAAA,aAAA;IAAAE,gBAAA,GAaTd,KAAK,CAZPe,SAAS;IAATA,SAAS,GAAAD,gBAAA,cAAG,EAAE,GAAAA,gBAAA;IAAAE,gBAAA,GAYZhB,KAAK,CAXPiB,SAAS;IAATA,SAAS,GAAAD,gBAAA,cAAG,EAAE,GAAAA,gBAAA;IAAAE,kBAAA,GAWZlB,KAAK,CAVPmB,WAAW;IAAEC,cAAc,GAAAF,kBAAA,cAAG,EAAE,GAAAA,kBAAA;IAAAG,YAAA,GAU9BrB,KAAK,CATPsB,KAAK;IAALA,KAAK,GAAAD,YAAA,cAAG,EAAE,GAAAA,YAAA;IAAAE,eAAA,GASRvB,KAAK,CARPwB,QAAQ;IAARA,QAAQ,GAAAD,eAAA,cAAG,EAAE,GAAAA,eAAA;IAAAE,eAAA,GAQXzB,KAAK,CAPP0B,QAAQ;IAARA,QAAQ,GAAAD,eAAA,cAAG,EAAE,GAAAA,eAAA;IAAAE,eAAA,GAOX3B,KAAK,CANP4B,QAAQ;IAARA,QAAQ,GAAAD,eAAA,cAAG,IAAI,GAAAA,eAAA;IAAAE,eAAA,GAMb7B,KAAK,CALP8B,QAAQ;IAARA,QAAQ,GAAAD,eAAA,cAAG,KAAK,GAAAA,eAAA;IAAAE,oBAAA,GAKd/B,KAAK,CAJPgC,aAAa;IAAEC,oBAAoB,GAAAF,oBAAA,cAAG,IAAI,GAAAA,oBAAA;IAAAG,iBAAA,GAIxClC,KAAK,CAHPmC,UAAU;IAAEC,iBAAiB,GAAAF,iBAAA,cAAG,IAAI,GAAAA,iBAAA;IACpCG,IAAI,GAEFrC,KAAK,CAFPqC,IAAI;IACJC,YAAY,GACVtC,KAAK,CADPsC,YAAY;EAEd,IAAAC,SAAA,GAAkC,IAAAC,eAAQ,GAAkB;IAAAC,UAAA,OAAAC,eAAA,aAAAH,SAAA;IAArDI,SAAS,GAAAF,UAAA;IAAEG,YAAY,GAAAH,UAAA;EAC9B,IAAAI,UAAA,GAAwB,IAAAL,eAAQ,GAAc;IAAAM,UAAA,OAAAJ,eAAA,aAAAG,UAAA;IAAvCE,IAAI,GAAAD,UAAA;IAAEE,OAAO,GAAAF,UAAA;EACpB,IAAAG,UAAA,GAA0B,IAAAT,eAAQ,GAAe;IAAAU,UAAA,OAAAR,eAAA,aAAAO,UAAA;IAA1CE,KAAK,GAAAD,UAAA;IAAEE,QAAQ,GAAAF,UAAA;EACtB,IAAMG,uBAAuB,GAAGC,gBAAU,CAAC3C,KAAK,CAC9C;IACE,GAAG,EAAE;MACH4C,eAAe,EAAE;IACnB;EACF,CAAC,EACD;IACEC,IAAI,EAAE;EACR,CAAC,CACF;EACD,IAAMC,kBAAkB,GAAGH,gBAAU,CAAC3C,KAAK,CAAC;IAC1C,GAAG,EAAE;MACHE,MAAM,EAANA,MAAM;MACNE,SAAS,EAATA,SAAS;MACTE,SAAS,EAATA,SAAS;MACTK,KAAK,EAALA,KAAK;MACLE,QAAQ,EAARA,QAAQ;MACRE,QAAQ,EAARA;IACF;EACF,CAAC,CAAC;EACF,IAAMgC,cAAc,GAAGJ,gBAAU,CAACI,cAAc,CAACC,EAAE,CAAC,UAACC,EAAc,EAAK;IACtE,IACEA,EAAE,CAACC,UAAU,IACb,OAAO1D,QAAQ,KAAK,UAAU;IAC9B;IACA;IACA,CAACyD,EAAE,CAACE,YAAY,CAACC,IAAI,CAAC,UAACC,EAAE;MAAA,OAAKA,EAAE,CAACC,UAAU,CAACrE,QAAQ,CAAC;IAAA,EAAC,EACtD;MACA,IAAMsE,GAAG,GAAGN,EAAE,CAACT,KAAK,CAACe,GAAG;MACxB,IAAMjE,MAAK,GAAGiE,GAAG,CAACC,QAAQ,EAAE;MAC5BhE,QAAQ,CAACF,MAAK,EAAE2D,EAAE,CAAC;IACrB;IACAxD,YAAY,IAAIA,YAAY,CAAC,IAAAgE,oBAAa,EAACR,EAAE,CAAC,CAAC;EACjD,CAAC,CAAC;EAEF,IAAIS,aAAa,GAAG,CAACX,cAAc,EAAED,kBAAkB,CAAC;EACxD,IAAIxB,oBAAoB,EAAE;IACxBoC,aAAa,CAACC,OAAO,CAACC,YAAM,CAACZ,EAAE,CAAC,CAAC3B,uBAAa,CAAC,CAAC,CAAC;EACnD;EACA,IAAII,iBAAiB,EAAE;IACrB,IAAI,OAAOA,iBAAiB,KAAK,SAAS,EAAE;MAC1CiC,aAAa,CAACC,OAAO,CAAC,IAAAnC,0CAAU,GAAE,CAAC;IACrC,CAAC,MAAM;MACLkC,aAAa,CAACC,OAAO,CAAC,IAAAnC,0CAAU,EAACC,iBAAiB,CAAC,CAAC;IACtD;EACF;EAEA,IAAIhB,cAAc,EAAE;IAClBiD,aAAa,CAACC,OAAO,CAAC,IAAAnD,iBAAW,EAACC,cAAc,CAAC,CAAC;EACpD;EAEA,QAAQT,KAAK;IACX,KAAK,OAAO;MACV0D,aAAa,CAACG,IAAI,CAACnB,uBAAuB,CAAC;MAC3C;IACF,KAAK,MAAM;MACTgB,aAAa,CAACG,IAAI,CAACC,qBAAO,CAAC;MAC3B;IACF,KAAK,MAAM;MACT;IACF;MACEJ,aAAa,CAACG,IAAI,CAAC7D,KAAK,CAAC;MACzB;EAAM;EAGV,IAAIiB,QAAQ,KAAK,KAAK,EAAE;IACtByC,aAAa,CAACG,IAAI,CAAClB,gBAAU,CAAC1B,QAAQ,CAAC+B,EAAE,CAAC,KAAK,CAAC,CAAC;EACnD;EACA,IAAI7B,QAAQ,EAAE;IACZuC,aAAa,CAACG,IAAI,CAACE,kBAAW,CAAC5C,QAAQ,CAAC6B,EAAE,CAAC,IAAI,CAAC,CAAC;EACnD;EAEA,IAAIrD,QAAQ,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAAE;IAC9C+D,aAAa,CAACG,IAAI,CAAClB,gBAAU,CAACI,cAAc,CAACC,EAAE,CAACrD,QAAQ,CAAC,CAAC;EAC5D;EACA+D,aAAa,GAAGA,aAAa,CAACM,MAAM,CAACnE,UAAU,CAAC;EAEhD,IAAAoE,gBAAS,EAAC,YAAM;IACd,IAAIjC,SAAS,IAAI,CAACQ,KAAK,EAAE;MACvB,IAAM0B,MAAM,GAAG;QACbX,GAAG,EAAEjE,KAAK;QACVC,SAAS,EAATA,SAAS;QACTM,UAAU,EAAE6D;MACd,CAAC;MACD,IAAMS,YAAY,GAAGxC,YAAY,GAC7BoC,kBAAW,CAACK,QAAQ,CAACzC,YAAY,CAAC0C,IAAI,EAAEH,MAAM,EAAEvC,YAAY,CAAC2C,MAAM,CAAC,GACpEP,kBAAW,CAACQ,MAAM,CAACL,MAAM,CAAC;MAC9BzB,QAAQ,CAAC0B,YAAY,CAAC;MACtB,IAAI,CAAC/B,IAAI,EAAE;QACT,IAAMoC,WAAW,GAAG,IAAI7B,gBAAU,CAAC;UACjCH,KAAK,EAAE2B,YAAY;UACnBM,MAAM,EAAEzC,SAAS;UACjBN,IAAI,EAAJA;QACF,CAAC,CAAC;QACFW,OAAO,CAACmC,WAAW,CAAC;QACpB9E,cAAc,IAAIA,cAAc,CAAC8E,WAAW,EAAEL,YAAY,CAAC;MAC7D;IACF;IACA,OAAO,YAAM;MACX,IAAI/B,IAAI,EAAE;QACRK,QAAQ,CAACiC,SAAS,CAAC;QACnBrC,OAAO,CAACqC,SAAS,CAAC;MACpB;IACF,CAAC;EACH,CAAC,EAAE,CAAC1C,SAAS,EAAEQ,KAAK,CAAC,CAAC;EAEtB,IAAAyB,gBAAS,EAAC;IAAA,OAAMhC,YAAY,CAAC5C,KAAK,CAAC2C,SAAS,CAAE;EAAA,GAAE,CAAC3C,KAAK,CAAC2C,SAAS,CAAC,CAAC;EAElE,IAAAiC,gBAAS,EACP;IAAA,OAAM,YAAM;MACV,IAAI7B,IAAI,EAAE;QACRA,IAAI,CAACuC,OAAO,EAAE;QACdtC,OAAO,CAACqC,SAAS,CAAC;MACpB;IACF,CAAC;EAAA,GACD,CAACtC,IAAI,CAAC,CACP;EAED,IAAA6B,gBAAS,EAAC,YAAM;IACd,IAAInE,SAAS,IAAIsC,IAAI,EAAE;MACrBA,IAAI,CAACwC,KAAK,EAAE;IACd;EACF,CAAC,EAAE,CAAC9E,SAAS,EAAEsC,IAAI,CAAC,CAAC;EAErB,IAAA6B,gBAAS,EAAC,YAAM;IACd,IAAI7B,IAAI,EAAE;MACRA,IAAI,CAACyC,QAAQ,CAAC;QAAEC,OAAO,EAAEC,kBAAW,CAACC,WAAW,CAAChC,EAAE,CAACU,aAAa;MAAE,CAAC,CAAC;IACvE;IACA;EACF,CAAC,EAAE,CACD1D,KAAK,EACLH,UAAU,EACVK,MAAM,EACNE,SAAS,EACTE,SAAS,EACTK,KAAK,EACLE,QAAQ,EACRE,QAAQ,EACRN,cAAc,EACdQ,QAAQ,EACRE,QAAQ,EACRG,oBAAoB,EACpBG,iBAAiB,EACjBjC,QAAQ,EACRG,QAAQ,CACT,CAAC;EAEF,IAAAsE,gBAAS,EAAC,YAAM;IACd,IAAI3E,KAAK,KAAKoF,SAAS,EAAE;MACvB;IACF;IACA,IAAMO,YAAY,GAAG7C,IAAI,GAAGA,IAAI,CAACI,KAAK,CAACe,GAAG,CAACC,QAAQ,EAAE,GAAG,EAAE;IAC1D,IAAIpB,IAAI,IAAI9C,KAAK,KAAK2F,YAAY,EAAE;MAClC7C,IAAI,CAACyC,QAAQ,CAAC;QACZK,OAAO,EAAE;UAAEC,IAAI,EAAE,CAAC;UAAEC,EAAE,EAAEH,YAAY,CAACI,MAAM;UAAEC,MAAM,EAAEhG,KAAK,IAAI;QAAG,CAAC;QAClEiG,WAAW,EAAE,CAACtG,QAAQ,CAAC+D,EAAE,CAAC,IAAI,CAAC;MACjC,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,CAAC1D,KAAK,EAAE8C,IAAI,CAAC,CAAC;EAEjB,OAAO;IAAEI,KAAK,EAALA,KAAK;IAAEC,QAAQ,EAARA,QAAQ;IAAEL,IAAI,EAAJA,IAAI;IAAEC,OAAO,EAAPA,OAAO;IAAEL,SAAS,EAATA,SAAS;IAAEC,YAAY,EAAZA;EAAa,CAAC;AACpE"
}